import{j as a,C as v,d as F}from"./index-akJh1a2u.js";import{u as M,A as l}from"./use-request-D0F366jR.js";import{r as s}from"./vendor-core-CiUIJZ_7.js";/* empty css               */import{U as P,u as V,r as O}from"./create-user-modal-BtGvwh1n.js";import{e as R,B as d,S as T,I as U,g as A,F as E,f as H,b as z,c as B,d as K,s as u}from"./vendor-ui-DnFwFa5O.js";import"./vendor-utils-IiNHtr66.js";const $={name:null,family:null,firstName:null,unitCode:null,rank:null,nationalId:null,accountNumber:null,bankCode:null,hsaSource:null,fmoSource:null,hsoSource:null,personnelId:null},X=()=>{const[p]=R.useForm(),[x,h]=s.useState([]),[S,k]=s.useState(""),[I,m]=s.useState(Date.now()),[o,i]=s.useState({show:!1,title:"افزودن کاربر",formValue:$}),r=M(),c=r.useGetData("api/personal",{Authorization:l}),b=r.useUpdateData("api/personal/"+o?.formValue.id,{"content-type":"application/json",Authorization:l}),C=r.usePostData("api/personal",{"content-type":"application/json",Authorization:l}),y=r.useDeleteData("api/personal/",{"content-type":"application/json",Authorization:l});s.useEffect(()=>{c.fetchData()},[I]),s.useEffect(()=>{const e=c.data;e?.success&&e.data&&h(e.data)},[c.data]);const f=()=>{i(e=>({...e,show:!1}))},j=async(e,t)=>{let n;t==="add"?n=await C.sendData({name:e.name,firstName:e.firstName,unitCode:e.unitCode,rank:e.rank,nationalId:e.nationalId,accountNumber:e.accountNumber,bankCode:e.bankCode,hsaSource:e.hsaSource,fmoSource:e.fmoSource,hsoSource:e.hsoSource,personnelId:e.personnelId}):n=await b.sendData({name:e.name,firstName:e.firstName,unitCode:e.unitCode,rank:e.rank,nationalId:e.nationalId,accountNumber:e.accountNumber,bankCode:e.bankCode,hsaSource:e.hsaSource,fmoSource:e.fmoSource,hsoSource:e.hsoSource,personnelId:e.personnelId}),n&&m(Date.now()),f()},N=async e=>{try{let t;e&&(t=await y.remove(e.toString())),t?.success?(u.success("با موفقیت حذف شد"),m(Date.now())):u.error("خطا در حذف")}catch(t){u.error(t.status==="500"?"خطا در ارتباط با سرور":"خطایی رخ داده است")}},g=[{title:"شماره پرسنلی",dataIndex:"personnelId",key:"personnelId"},{title:"نام",dataIndex:"firstName",key:"firstName",filteredValue:[S]},{title:"کد یگان",dataIndex:"unitCode",key:"unitCode",render:e=>V.find(t=>t.value===e)?.label||e},{title:"درجه",dataIndex:"rank",key:"rank",render:e=>O.find(t=>t.value===e)?.label||e},{title:"شماره ملی",dataIndex:"nationalId",key:"nationalId"},{title:"شماره حساب",dataIndex:"accountNumber",key:"accountNumber"},{title:"کد بانک",dataIndex:"bankCode",key:"bankCode"},{title:"ماخذ HSA",dataIndex:"hsaSource",key:"hsaSource"},{title:"ماخذ FMO",dataIndex:"fmoSource",key:"fmoSource"},{title:"ماخذ HSO",dataIndex:"hsoSource",key:"hsoSource"},{title:"عملیات",key:"action",render:(e,t)=>a.jsxs(H,{size:"middle",children:[a.jsx(d,{type:"link",icon:a.jsx(z,{}),onClick:()=>i(n=>({...n,show:!0,title:"ویرایش شخص"})),children:"ویرایش"}),a.jsx(B,{title:"آیا از حذف این کاربر مطمئن هستید؟",onConfirm:()=>N(t.id?t.id:null),okText:"بله",cancelText:"خیر",children:a.jsx(d,{type:"link",danger:!0,icon:a.jsx(K,{}),children:"حذف"})})]})}];return a.jsxs(v,{children:[a.jsx(F,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"font-bold text-3xl",children:"لیست پرسنل"}),a.jsxs("div",{className:"flex items-center  gap-2",children:[a.jsx(d,{type:"primary",onClick:()=>{p.resetFields(),i(e=>({...e,show:!0}))},children:"افزودن کاربر جدید"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(T,{defaultValue:"firstName",className:"w-60",options:[{label:"نام",value:"firstName"},{label:"شماره پرسنلی",value:"personnelId"},{label:"شماره ملی",value:"nationalId"},{label:"کد یگان",value:"unitCode"},{label:"درجه",value:"rank"}]}),a.jsx(U,{className:"w-80",placeholder:"عبارت انتخاب شده را جستجو کنید",prefix:a.jsx(A,{}),onChange:e=>k(e.target.value)})]})]})]})}),o.show&&a.jsx(P,{show:o.show,title:o.title,formValue:o.formValue,onOk:j,onCancel:f}),a.jsx(E,{columns:g,dataSource:x,pagination:{pageSize:10},scroll:{x:1500}})]})};export{X as default};
