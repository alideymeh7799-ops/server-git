import{aS as s,j as e,D,E as I,F as P,G as y,H as G,B as g,a3 as O,C as k,d as F,e as C}from"./index-akJh1a2u.js";import{t as f,h as L,u as N,r as U,F as w}from"./vendor-ui-DnFwFa5O.js";import{r as i}from"./vendor-core-CiUIJZ_7.js";import{F as H,a as S,b as T,e as A,c as R}from"./form-Cjy9Qfuo.js";import{I as b}from"./input-DybMe5F1.js";import{T as M}from"./textarea-CpYHWTAr.js";import{u as v}from"./index.esm-BGUB25Qb.js";import{u as B,b as _}from"./user-Broof_Gn.js";import{u as K}from"./use-request-D0F366jR.js";import"./vendor-utils-IiNHtr66.js";const Z={CREATE:{key:"create",label:"ساخت"},UPDATE:{key:"update",label:"ویرایش"},GETALL:{key:"getAll",label:"دریافت همه"},GETONE:{key:"getOne",label:"دریافت تکی"},DELETE:{key:"delete",label:"حذف"},SOFTDELETE:{key:"softDelete",label:"حذف نرم"},RESTORE:{key:"restore",label:"بازیابی"},GETDELETED:{key:"getDeleted",label:"دریافت حذف‌شده‌ها"},SEARCH:{key:"search",label:"جستجو"},BATCHDELETE:{key:"batchDelete",label:"حذف دسته‌ای"},BATCHRESTORE:{key:"batchRestore",label:"بازیابی دسته‌ای"}},J=[{title:"ثبت اطلاعات پایه سامانه",children:[{title:"ثبت یگان",path:s.SETTINGS.YEGAN},{title:"عامل خرید",path:s.SETTINGS.AMELE_KHARID},{title:"ثبت امضا کنندگان تنخواه",path:s.SETTINGS.EMZA_TANKHAH},{title:"ثبت امضاء کنندگان تخصیص  ",path:s.SETTINGS.EMZA_SANAD_BARGASHTI},{title:"ثبت امضا کنندگان تخصیص",path:s.SETTINGS.EMZA_TAKHSIS},{title:"ثبت اطلاعات یگان واگذار",path:s.SETTINGS.YEGAN_VAGOZAR},{title:"مدیریت پیمانکاران",path:s.SETTINGS.PEYMANKAR},{title:"مدیریت فعالیت",path:s.SETTINGS.FAALIAT},{title:"مدیریت برنامه ",path:s.SETTINGS.BARNAME}]},{title:" اطلاعات مالی و حسابداری",children:[{title:"اعتبارات بودجه‌ای",children:[{title:" ثبت اعتبار / برگ اعتبار",path:s.BUDGET.CREDIT},{title:"ثبت تخصیص اعتبار",path:s.BUDGET.TAKHSIS},{title:"ثبت پرداخت / نقد پرداخت",path:s.BUDGET.TANKHAH},{title:"ثبت سند برگشتی / اعلامیه",path:s.BUDGET.ELAMIE}]},{title:"اضافه کار",children:[{title:"فرم اضافه کار",path:s.EZAFEKAR.FORM},{title:"گزارش اضافه کار",path:s.EZAFEKAR.REPORT}]},{title:" پاداش",children:[{title:" ثبت پاداش  ",path:s.PADASH.FORM},{title:" گزارشات ",path:s.PADASH.REPORT}]}]},{title:"ثبت  انتقالات و گزارشات",children:[{title:"ثبت قرمز کردن اعتبار",path:s.TRANSFERS.GHERMEZ},{title:"گزارشات قرمز کردن   ",path:s.TRANSFERS.GHERMEZ_REPORT},{title:"ثبت   جابجایی",path:s.TRANSFERS.JABEJAE},{title:"   گزارشات جابجایی",path:s.TRANSFERS.JABEJAE_REPORT}]},{title:"مدیریت و بررسی کاربران",children:[{title:"مدیریت کادر پایور (پرسنل)",path:s.USERS.PERSONS},{title:"مدیریت کاربران (ادمین  ها)",path:s.USERS.ADMINS},{title:" مدیریت نقش ها",path:s.USERS.ROLES},{title:"مدیریت   تعیین سطح دسترسی",path:s.USERS.PERMISSION}]},{title:"گزارشات",children:[{title:"مشاهده گزارشات سامانه",path:s.USERS.AUTH_REPORT}]}],{Panel:Y}=f;function V({title:E,show:c,formValue:n,onOk:x,onCancel:h}){const r=v({defaultValues:n});i.useEffect(()=>{r.reset(n)},[n,r]);const u=r.handleSubmit(x),[p,o]=i.useState({}),j=(a,t)=>{o(l=>({...l,[a]:t}))},d=a=>a.path?e.jsxs("div",{className:"tree-item",children:[e.jsx("span",{className:"tree-title",children:a.title}),e.jsx(U.Group,{options:Object.values(Z).map(t=>({label:t.label,value:t.key})),value:p[a.path],onChange:t=>j(a.path,t)})]}):e.jsx("strong",{children:a.title}),m=a=>a.map(t=>({title:t.title,key:t.path||t.title,path:t.path,children:t.children?m(t.children):[]}));return e.jsx(D,{open:c,onOpenChange:a=>!a&&h(),children:e.jsxs(I,{children:[e.jsx(P,{children:e.jsx(y,{children:E})}),e.jsx(H,{...r,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{control:r.control,name:"name",render:({field:a})=>e.jsxs(T,{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(A,{className:"text-right",children:"نام نقش"}),e.jsx("div",{className:"col-span-3",children:e.jsx(R,{children:e.jsx(b,{...a})})})]})}),e.jsx(S,{control:r.control,name:"code",render:({field:a})=>e.jsxs(T,{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(A,{className:"text-right",children:"کد نقش"}),e.jsx("div",{className:"col-span-3",children:e.jsx(R,{children:e.jsx(b,{...a})})})]})}),e.jsx(S,{control:r.control,name:"desc",render:({field:a})=>e.jsxs(T,{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(A,{className:"text-right",children:"توضیحات"}),e.jsx("div",{className:"col-span-3",children:e.jsx(R,{children:e.jsx(M,{...a})})})]})}),e.jsx("div",{className:"w-full my-4 mb-4 font-semibold text-foreground text-xl",children:"ثبت دسترسی"}),e.jsx(f,{accordion:!0,expandIconPosition:"right",className:"max-h-[340px]  overflow-auto w-full px-2",expandIcon:({isActive:a})=>e.jsx(N,{style:{transform:a?"rotate(90deg)":"rotate(-180deg)",transition:"transform 0.3s ease"},className:"RightOutlined-collapse"}),children:J.map((a,t)=>e.jsx(Y,{header:a.title,children:e.jsx(L,{switcherIcon:({expanded:l})=>e.jsx(N,{style:{transform:l?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.3s ease"},className:"RightOutlined-tree"}),treeData:m(a.children),titleRender:d,defaultExpandAll:!0,className:"custom-tree"})},t))})]})}),e.jsxs(G,{className:"pt-4",children:[e.jsx(g,{className:"bg-error hover:bg-error text-white",onClick:h,children:"انصراف"}),e.jsx(g,{className:"bg-primary text-white",onClick:u,children:"ذخیره"})]})]})})}const z={id:"",name:"",code:"",desc:"",permission:[]},$=[{id:"1",name:"مدیر سیستم",code:"admin",desc:"دسترسی کامل به همه بخش‌ها",status:0,order:1,permission:[{id:"p1",parentId:"",name:"Dashboard",label:"داشبورد",type:0,route:"/dashboard",icon:"dashboard",status:0,order:1,component:"DashboardPage",children:[]},{id:"p2",parentId:"",name:"User Management",label:"مدیریت کاربران",type:0,route:"/users",icon:"users",status:1,order:2,component:"UserPage",children:[{id:"p2-1",parentId:"p2",name:"Add User",label:"افزودن کاربر",type:1,route:"/users/add",order:1,component:"AddUserPage"},{id:"p2-2",parentId:"p2",name:"Edit User",label:"ویرایش کاربر",type:0,route:"/users/edit",order:2,component:"EditUserPage"}]}]},{id:"2",name:"اپراتور",code:"operator",desc:"دسترسی محدود به بخش کاربران",status:1,order:2,permission:[{id:"p3",parentId:"",name:"User View",label:"مشاهده کاربران",type:1,route:"/users",icon:"eye",status:0,order:1,component:"UserPage"}]},{id:"3",name:"مهمان",code:"guest",desc:"فقط دسترسی به مشاهده داشبورد",status:0,order:3,permission:[{id:"p4",parentId:"",name:"Dashboard",label:"داشبورد",type:1,route:"/dashboard",icon:"dashboard",status:1,order:1,component:"DashboardPage"}]}];function q(){const{can:E}=B(),{operationList:c,resourceList:n}=O,[x,h]=i.useState(Date.now()),[r,u]=i.useState([]),[p,o]=i.useState({formValue:{...z},title:"اعطای دسترسی",show:!1,onOk:()=>{o(t=>({...t,show:!1}))},onCancel:()=>{o(t=>({...t,show:!1}))}}),d=K().useGetData(_(n.PERMISSIONS,c.GETALL));i.useEffect(()=>{E(n.PERSONS,c.GETALL)&&d.fetchData()},[x]),i.useEffect(()=>{const t=d.data;t?.success&&t.data?u(t.data):h(Date.now())},[d.data]);const m=[{title:"نام نقش",dataIndex:"name",width:300},{title:"کد نقش",dataIndex:"code"},{title:"توضیحات",dataIndex:"desc"},{title:"عملیات",key:"operation",align:"center",width:200,render:(t,l)=>e.jsx("div",{className:"flex w-full justify-center gap-2 text-gray",children:e.jsx(g,{className:"bg-chart3 text-white font-bold",onClick:()=>a(l),children:"ثبت دسترسی"})})}],a=t=>{o(l=>({...l,show:!0,title:`ثبت دسترسی برای ${t.name}`,formValue:t}))};return e.jsxs(k,{children:[e.jsx(F,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{children:"مدیریت دسترسی ها"})})}),e.jsx(C,{children:e.jsx(w,{rowKey:"id",size:"small",scroll:{x:"max-content"},pagination:!1,columns:m,dataSource:$})}),p.show&&e.jsx(V,{...p})]})}const ne=()=>e.jsx(q,{});export{ne as default};
