import{p as Ae,j as l,o as K,i as We,k as Le,m as _e,B as He}from"./index-akJh1a2u.js";import{F as $e,a as ve,b as ge,e as xe,c as be,d as je}from"./form-Cjy9Qfuo.js";import{I as Ge}from"./input-DybMe5F1.js";import{r as t}from"./vendor-core-CiUIJZ_7.js";import{u as ze}from"./index.esm-BGUB25Qb.js";import{ReturnButton as qe}from"./ReturnButton-y51eT2qf.js";import"./vendor-utils-IiNHtr66.js";import"./vendor-ui-DnFwFa5O.js";const Ve=[["path",{d:"M5 12h14",key:"1ays0h"}]],Ze=Ae("minus",Ve);var Qe=Object.defineProperty,Je=Object.defineProperties,Ke=Object.getOwnPropertyDescriptors,U=Object.getOwnPropertySymbols,ye=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable,we=(e,r,a)=>r in e?Qe(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a,Ue=(e,r)=>{for(var a in r||(r={}))ye.call(r,a)&&we(e,a,r[a]);if(U)for(var a of U(r))Ee.call(r,a)&&we(e,a,r[a]);return e},Xe=(e,r)=>Je(e,Ke(r)),Ye=(e,r)=>{var a={};for(var i in e)ye.call(e,i)&&r.indexOf(i)<0&&(a[i]=e[i]);if(e!=null&&U)for(var i of U(e))r.indexOf(i)<0&&Ee.call(e,i)&&(a[i]=e[i]);return a};function et(e){let r=setTimeout(e,0),a=setTimeout(e,10),i=setTimeout(e,50);return[r,a,i]}function tt(e){let r=t.useRef();return t.useEffect(()=>{r.current=e}),r.current}var nt=18,Ce=40,rt=`${Ce}px`,at=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function lt({containerRef:e,inputRef:r,pushPasswordManagerStrategy:a,isFocused:i}){let[h,c]=t.useState(!1),[E,g]=t.useState(!1),[k,M]=t.useState(!1),R=t.useMemo(()=>a==="none"?!1:(a==="increase-width"||a==="experimental-no-flickering")&&h&&E,[h,E,a]),j=t.useCallback(()=>{let m=e.current,T=r.current;if(!m||!T||k||a==="none")return;let w=m,C=w.getBoundingClientRect().left+w.offsetWidth,W=w.getBoundingClientRect().top+w.offsetHeight/2,u=C-nt,$=W;document.querySelectorAll(at).length===0&&document.elementFromPoint(u,$)===m||(c(!0),M(!0))},[e,r,k,a]);return t.useEffect(()=>{let m=e.current;if(!m||a==="none")return;function T(){let C=window.innerWidth-m.getBoundingClientRect().right;g(C>=Ce)}T();let w=setInterval(T,1e3);return()=>{clearInterval(w)}},[e,a]),t.useEffect(()=>{let m=i||document.activeElement===r.current;if(a==="none"||!m)return;let T=setTimeout(j,0),w=setTimeout(j,2e3),C=setTimeout(j,5e3),W=setTimeout(()=>{M(!0)},6e3);return()=>{clearTimeout(T),clearTimeout(w),clearTimeout(C),clearTimeout(W)}},[r,i,a,j]),{hasPWMBadge:h,willPushPWMBadge:R,PWM_BADGE_SPACE_WIDTH:rt}}var Pe=t.createContext({}),ke=t.forwardRef((e,r)=>{var a=e,{value:i,onChange:h,maxLength:c,textAlign:E="left",pattern:g,placeholder:k,inputMode:M="numeric",onComplete:R,pushPasswordManagerStrategy:j="increase-width",pasteTransformer:m,containerClassName:T,noScriptCSSFallback:w=ot,render:C,children:W}=a,u=Ye(a,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),$,ae,le,oe,ie;let[Me,Te]=t.useState(typeof u.defaultValue=="string"?u.defaultValue:""),d=i??Me,B=tt(d),G=t.useCallback(n=>{h?.(n),Te(n)},[h]),y=t.useMemo(()=>g?typeof g=="string"?new RegExp(g):g:null,[g]),p=t.useRef(null),X=t.useRef(null),Y=t.useRef({value:d,onChange:G,isIOS:typeof window<"u"&&((ae=($=window?.CSS)==null?void 0:$.supports)==null?void 0:ae.call($,"-webkit-touch-callout","none"))}),Q=t.useRef({prev:[(le=p.current)==null?void 0:le.selectionStart,(oe=p.current)==null?void 0:oe.selectionEnd,(ie=p.current)==null?void 0:ie.selectionDirection]});t.useImperativeHandle(r,()=>p.current,[]),t.useEffect(()=>{let n=p.current,o=X.current;if(!n||!o)return;Y.current.value!==n.value&&Y.current.onChange(n.value),Q.current.prev=[n.selectionStart,n.selectionEnd,n.selectionDirection];function f(){if(document.activeElement!==n){q(null),V(null);return}let s=n.selectionStart,v=n.selectionEnd,J=n.selectionDirection,S=n.maxLength,N=n.value,P=Q.current.prev,F=-1,I=-1,D;if(N.length!==0&&s!==null&&v!==null){let Oe=s===v,Ne=s===N.length&&N.length<S;if(Oe&&!Ne){let A=s;if(A===0)F=0,I=1,D="forward";else if(A===S)F=A-1,I=A,D="backward";else if(S>1&&N.length>1){let ne=0;if(P[0]!==null&&P[1]!==null){D=A<P[1]?"backward":"forward";let De=P[0]===P[1]&&P[0]<S;D==="backward"&&!De&&(ne=-1)}F=ne+A,I=ne+A+1}}F!==-1&&I!==-1&&F!==I&&p.current.setSelectionRange(F,I,D)}let fe=F!==-1?F:s,he=I!==-1?I:v,Be=D??J;q(fe),V(he),Q.current.prev=[fe,he,Be]}if(document.addEventListener("selectionchange",f,{capture:!0}),f(),document.activeElement===n&&ee(!0),!document.getElementById("input-otp-style")){let s=document.createElement("style");if(s.id="input-otp-style",document.head.appendChild(s),s.sheet){let v="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";Z(s.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),Z(s.sheet,`[data-input-otp]:autofill { ${v} }`),Z(s.sheet,`[data-input-otp]:-webkit-autofill { ${v} }`),Z(s.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),Z(s.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let x=()=>{o&&o.style.setProperty("--root-height",`${n.clientHeight}px`)};x();let b=new ResizeObserver(x);return b.observe(n),()=>{document.removeEventListener("selectionchange",f,{capture:!0}),b.disconnect()}},[]);let[se,ue]=t.useState(!1),[z,ee]=t.useState(!1),[O,q]=t.useState(null),[L,V]=t.useState(null);t.useEffect(()=>{et(()=>{var n,o,f,x;(n=p.current)==null||n.dispatchEvent(new Event("input"));let b=(o=p.current)==null?void 0:o.selectionStart,s=(f=p.current)==null?void 0:f.selectionEnd,v=(x=p.current)==null?void 0:x.selectionDirection;b!==null&&s!==null&&(q(b),V(s),Q.current.prev=[b,s,v])})},[d,z]),t.useEffect(()=>{B!==void 0&&d!==B&&B.length<c&&d.length===c&&R?.(d)},[c,R,B,d]);let _=lt({containerRef:X,inputRef:p,pushPasswordManagerStrategy:j,isFocused:z}),ce=t.useCallback(n=>{let o=n.currentTarget.value.slice(0,c);if(o.length>0&&y&&!y.test(o)){n.preventDefault();return}typeof B=="string"&&o.length<B.length&&document.dispatchEvent(new Event("selectionchange")),G(o)},[c,G,B,y]),de=t.useCallback(()=>{var n;if(p.current){let o=Math.min(p.current.value.length,c-1),f=p.current.value.length;(n=p.current)==null||n.setSelectionRange(o,f),q(o),V(f)}ee(!0)},[c]),pe=t.useCallback(n=>{var o,f;let x=p.current;if(!m&&(!Y.current.isIOS||!n.clipboardData||!x))return;let b=n.clipboardData.getData("text/plain"),s=m?m(b):b;n.preventDefault();let v=(o=p.current)==null?void 0:o.selectionStart,J=(f=p.current)==null?void 0:f.selectionEnd,S=(v!==J?d.slice(0,v)+s+d.slice(J):d.slice(0,v)+s+d.slice(v)).slice(0,c);if(S.length>0&&y&&!y.test(S))return;x.value=S,G(S);let N=Math.min(S.length,c-1),P=S.length;x.setSelectionRange(N,P),q(N),V(P)},[c,G,y,d]),Fe=t.useMemo(()=>({position:"relative",cursor:u.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[u.disabled]),me=t.useMemo(()=>({position:"absolute",inset:0,width:_.willPushPWMBadge?`calc(100% + ${_.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:_.willPushPWMBadge?`inset(0 ${_.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:E,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[_.PWM_BADGE_SPACE_WIDTH,_.willPushPWMBadge,E]),Ie=t.useMemo(()=>t.createElement("input",Xe(Ue({autoComplete:u.autoComplete||"one-time-code"},u),{"data-input-otp":!0,"data-input-otp-placeholder-shown":d.length===0||void 0,"data-input-otp-mss":O,"data-input-otp-mse":L,inputMode:M,pattern:y?.source,"aria-placeholder":k,style:me,maxLength:c,value:d,ref:p,onPaste:n=>{var o;pe(n),(o=u.onPaste)==null||o.call(u,n)},onChange:ce,onMouseOver:n=>{var o;ue(!0),(o=u.onMouseOver)==null||o.call(u,n)},onMouseLeave:n=>{var o;ue(!1),(o=u.onMouseLeave)==null||o.call(u,n)},onFocus:n=>{var o;de(),(o=u.onFocus)==null||o.call(u,n)},onBlur:n=>{var o;ee(!1),(o=u.onBlur)==null||o.call(u,n)}})),[ce,de,pe,M,me,c,L,O,u,y?.source,d]),te=t.useMemo(()=>({slots:Array.from({length:c}).map((n,o)=>{var f;let x=z&&O!==null&&L!==null&&(O===L&&o===O||o>=O&&o<L),b=d[o]!==void 0?d[o]:null,s=d[0]!==void 0?null:(f=k?.[o])!=null?f:null;return{char:b,placeholderChar:s,isActive:x,hasFakeCaret:x&&b===null}}),isFocused:z,isHovering:!u.disabled&&se}),[z,se,c,L,O,u.disabled,d]),Re=t.useMemo(()=>C?C(te):t.createElement(Pe.Provider,{value:te},W),[W,te,C]);return t.createElement(t.Fragment,null,w!==null&&t.createElement("noscript",null,t.createElement("style",null,w)),t.createElement("div",{ref:X,"data-input-otp-container":!0,style:Fe,className:T},Re,t.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Ie)))});ke.displayName="Input";function Z(e,r){try{e.insertRule(r)}catch{}}var ot=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`,it="^[a-zA-Z0-9]+$";function st({className:e,containerClassName:r,...a}){return l.jsx(ke,{"data-slot":"input-otp",containerClassName:K("flex items-center gap-2 has-disabled:opacity-50",r),className:K("disabled:cursor-not-allowed",e),...a})}function re({className:e,...r}){return l.jsx("div",{"data-slot":"input-otp-group",className:K("flex items-center",e),...r})}function H({index:e,className:r,...a}){const i=t.useContext(Pe),{char:h,hasFakeCaret:c,isActive:E}=i?.slots[e]??{};return l.jsxs("div",{"data-slot":"input-otp-slot","data-active":E,className:K("data-[active=true]:border-ring data-[active=true]:ring-ring/50 data-[active=true]:aria-invalid:ring-destructive/20 dark:data-[active=true]:aria-invalid:ring-destructive/40 aria-invalid:border-destructive data-[active=true]:aria-invalid:border-destructive dark:bg-input/30 border-input relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none first:rounded-l-md first:border-l last:rounded-r-md data-[active=true]:z-10 data-[active=true]:ring-[3px]",r),...a,children:[h,c&&l.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:l.jsx("div",{className:"animate-caret-blink bg-foreground h-4 w-px duration-1000"})})]})}function Se({...e}){return l.jsx("div",{"data-slot":"input-otp-separator",role:"separator",...e,children:l.jsx(Ze,{})})}function ut({value:e,onChange:r,onFinish:a}){return t.useEffect(()=>{if(e<=0){a();return}const i=setInterval(()=>{r(e-1)},1e3);return()=>clearInterval(i)},[e,r,a]),null}function xt(){const{t:e}=We(),[r,a]=t.useState(0),[i,h]=t.useState(0),{loginState:c,backToLogin:E}=Le(),g=ze({defaultValues:{phone:"",code:""}});if(c!==_e.MOBILE)return null;const k=()=>{a(60),h(60)},M=()=>{a(0),h(60)},R=j=>{};return l.jsx($e,{...g,children:l.jsxs("form",{onSubmit:g.handleSubmit(R),className:"space-y-4",children:[l.jsx("div",{className:"flex flex-col items-center gap-2 text-center",children:l.jsx("h1",{className:"text-2xl font-bold",children:e("sys.login.mobileSignInFormTitle")})}),l.jsx(ve,{control:g.control,name:"phone",rules:{required:e("sys.login.mobilePlaceholder")},render:({field:j})=>l.jsxs(ge,{children:[l.jsx(xe,{children:e("sys.login.mobile")}),l.jsx(be,{children:l.jsx(Ge,{placeholder:e("sys.login.mobile"),...j})}),l.jsx(je,{})]})}),l.jsx(ve,{control:g.control,name:"code",rules:{required:e("sys.login.smsPlaceholder")},render:({field:j})=>l.jsxs(ge,{children:[l.jsxs(xe,{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm",children:e("sys.login.smsCode")}),l.jsx("span",{className:"text-sm text-muted-foreground",onClick:k,children:r===0?l.jsx("span",{children:e("sys.login.sendSmsButton")}):l.jsxs("div",{className:"flex items-center justify-center",children:[l.jsx(ut,{value:r,onChange:m=>{a(m),h(m)},onFinish:M}),l.jsx("span",{className:"ml-1",children:e("sys.login.sendSmsText",{second:i})})]})})]}),l.jsx(be,{children:l.jsxs(st,{maxLength:6,pattern:it,...j,children:[l.jsxs(re,{children:[l.jsx(H,{index:0}),l.jsx(H,{index:1})]}),l.jsx(Se,{}),l.jsxs(re,{children:[l.jsx(H,{index:2}),l.jsx(H,{index:3})]}),l.jsx(Se,{}),l.jsxs(re,{children:[l.jsx(H,{index:4}),l.jsx(H,{index:5})]})]})}),l.jsx(je,{})]})}),l.jsx(He,{type:"submit",className:"w-full",children:e("sys.login.loginButton")}),l.jsx(qe,{onClick:()=>{M(),E()}})]})})}export{xt as default};
