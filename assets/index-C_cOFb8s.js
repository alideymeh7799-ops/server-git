import{j as e,o as F,B as g,i as D,C as K,d as O,e as R}from"./index-akJh1a2u.js";import{r as o}from"./vendor-core-CiUIJZ_7.js";import{e as C,M as P,I as x,F as I,p as L,q as U,s as p,r as B,S as T}from"./vendor-ui-DnFwFa5O.js";import"./vendor-utils-IiNHtr66.js";function Q({user:l,show:f,onOk:j,onCancel:h,defaultValues:m}){const[a]=C.useForm();return o.useEffect(()=>{m?a.setFieldsValue(m):a.resetFields()},[m,a]),e.jsxs(P,{title:"ثبت پاداش",open:f,onCancel:()=>{a.resetFields(),h()},onOk:()=>a.submit(),okText:"ثبت",cancelText:"انصراف",children:[e.jsxs("div",{className:"mb-4 space-y-1",children:[e.jsxs("div",{children:["نام: ",l.firstName]}),e.jsxs("div",{children:["نام خانوادگی: ",l.family]}),e.jsxs("div",{children:["کد ملی: ",l.nationalId]})]}),e.jsxs(C,{form:a,layout:"vertical",onFinish:j,children:[e.jsx(C.Item,{label:"مبلغ پاداش",name:"amount",rules:[{required:!0,message:"مقدار را وارد کنید"}],children:e.jsx(x,{type:"number"})}),e.jsx(C.Item,{label:"تاریخ تنظیم",name:"date",rules:[{required:!0,message:"تاریخ را وارد کنید"}],children:e.jsx(x,{type:"date"})}),e.jsx(C.Item,{label:"شماره سند",name:"docNumber",rules:[{required:!0,message:"شماره سند را وارد کنید"}],children:e.jsx(x,{})})]})]})}const z=[{id:1,name:"افسر ۱",amount:1e6,desc:"برای خرید تجهیزات",account:"123456"},{id:2,name:"افسر ۲",amount:15e5,desc:"برای تعمیرات",account:"789456"}],H=[{id:3,name:"هزینه ۱",amount:5e5,desc:"هزینه ایاب و ذهاب",account:"987654"},{id:4,name:"هزینه ۲",amount:8e5,desc:"هزینه پذیرایی",account:"321654"}];function G({open:l,onClose:f}){const[j,h]=o.useState(null),[m,a]=o.useState(null),[r,y]=o.useState({officer:"",amount:"",desc:""}),[c,d]=o.useState({amount:"",desc:"",date:""}),b=()=>{if(!r.officer||!r.amount)return p.error("لطفا اطلاعات را کامل کنید");p.success("تنخواه ثبت شد"),h(null),y({officer:"",amount:"",desc:""})},v=()=>{if(!c.amount||!c.date)return p.error("لطفا اطلاعات را کامل کنید");p.success("پرداخت نقدی ثبت شد"),a(null),d({amount:"",desc:"",date:""})},w=t=>[{title:"",dataIndex:"checkbox",render:(k,S)=>e.jsx(B,{checked:t===S.id})},{title:"نام",dataIndex:"name"},{title:"مبلغ",dataIndex:"amount"},{title:"شرح",dataIndex:"desc"},{title:"شماره حساب",dataIndex:"account"}],i=[{key:"petty",label:"تنخواه",children:e.jsxs("div",{children:[e.jsx(I,{rowKey:"id",dataSource:z,columns:w(j),onRow:t=>({onClick:()=>h(t.id),className:F({"bg-green-100":j===t.id,"cursor-pointer":!0})}),pagination:!1}),j&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx(x,{placeholder:"افسر خرید",value:r.officer,onChange:t=>y({...r,officer:t.target.value})}),e.jsx(x,{placeholder:"مبلغ",value:r.amount,onChange:t=>y({...r,amount:t.target.value})}),e.jsx(x.TextArea,{placeholder:"شرح",value:r.desc,onChange:t=>y({...r,desc:t.target.value})}),e.jsx(g,{onClick:b,className:"bg-green-600 text-white",children:"ثبت"})]})]})},{key:"cash",label:"نقد پرداخت",children:e.jsxs("div",{children:[e.jsx(I,{rowKey:"id",dataSource:H,columns:w(m),onRow:t=>({onClick:()=>a(t.id),className:F({"bg-blue-100":m===t.id,"cursor-pointer":!0})}),pagination:!1}),m&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx(x,{placeholder:"مبلغ",value:c.amount,onChange:t=>d({...c,amount:t.target.value})}),e.jsx(x.TextArea,{placeholder:"شرح هزینه",value:c.desc,onChange:t=>d({...c,desc:t.target.value})}),e.jsx(L,{placeholder:"تاریخ",className:"w-full",onChange:t=>d({...c,date:t.toLocaleString()})}),e.jsx(g,{onClick:v,className:"bg-blue-600 text-white",children:"ثبت"})]})]})}];return e.jsx(P,{open:l,onCancel:f,footer:null,title:"تخصیص اعتبار",width:800,children:e.jsx(U,{items:i})})}const{Option:N}=T,M=[{id:1,name:"Ali",family:"Rezaei",firstName:"Ali",unitCode:"123",rank:"سرگرد",nationalId:"1234567890",accountNumber:"1111111",bankCode:"012",hsaSource:"src1",fmoSource:"src2",hsoSource:"src3",personnelId:"998877"}];function J(){const{t:l}=D(),[f,j]=o.useState("name"),[h,m]=o.useState(""),[a,r]=o.useState(null),[y,c]=o.useState(!1),[d,b]=o.useState(null),[v,w]=o.useState(!1),[i,t]=o.useState([]),k=o.useMemo(()=>M.filter(s=>{const n=s[f];return n?n.toString().toLowerCase().includes(h.toLowerCase()):!1}),[M,h,f]),S=s=>{r(s),b(null),w(!0)},A=s=>{if(!a)return;const n={personal:a,...s};if(d!==null){const u=[...i];u[d]=n,t(u),p.success("پاداش ویرایش شد")}else t(u=>[...u,n]),p.success("پاداش ثبت شد");w(!1)},_=s=>{const n=i[s];r(n.personal),b(s),w(!0)},E=s=>{if(!window.confirm("آیا مطمئن هستید که می‌خواهید حذف کنید؟"))return;const u=[...i];u.splice(s,1),t(u),p.success("پاداش حذف شد")},q=[{title:l("نام"),dataIndex:"firstName",key:"firstName"},{title:l("نام خانوادگی"),dataIndex:"family",key:"family"},{title:l("کد ملی"),dataIndex:"nationalId",key:"nationalId"},{title:l("شماره پرسنلی"),dataIndex:"personnelId",key:"personnelId"},{title:l("عملیات"),key:"actions",render:(s,n)=>e.jsx(g,{className:"bg-chart3 hover:bg-chart3/80 text-white rounded-2xl py-1 px-2 text-xs",onClick:()=>S(n),children:"ثبت پاداش"})}];return e.jsxs(K,{children:[e.jsx(O,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 w-full",children:[e.jsx("div",{className:"text-lg font-semibold text-right w-full sm:w-auto",children:l("لیست کاربران")}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center gap-4 w-full sm:w-auto",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-center border p-3 rounded-md bg-card text-card-foreground w-full sm:w-auto",children:[e.jsx(x,{placeholder:l("جستجو..."),value:h,onChange:s=>m(s.target.value),allowClear:!0,className:"w-full sm:w-52"}),e.jsxs(T,{value:f,onChange:s=>j(s),className:"w-48",children:[e.jsx(N,{value:"name",children:"نام"}),e.jsx(N,{value:"family",children:"نام خانوادگی"}),e.jsx(N,{value:"nationalId",children:"کد ملی"}),e.jsx(N,{value:"personnelId",children:"شماره پرسنلی"})]})]})})]})}),e.jsx(R,{className:"w-full",children:e.jsx(I,{rowKey:"id",columns:q,dataSource:k})}),i.length>0&&e.jsxs(R,{className:"w-full mt-6 border-t pt-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"لیست پاداش‌های انتخاب شده"}),e.jsx(g,{onClick:()=>c(!0),className:"bg-redStorm text-white px-4 py-1 rounded-md text-sm",children:"تخصیص اعتبار"})]}),e.jsx(I,{rowKey:(s,n)=>n.toString(),columns:[{title:"نام",dataIndex:["personal","firstName"],key:"firstName"},{title:"نام خانوادگی",dataIndex:["personal","family"],key:"family"},{title:"مبلغ پاداش",dataIndex:"amount",key:"amount"},{title:"تاریخ تنظیم",dataIndex:"date",key:"date"},{title:"شماره سند",dataIndex:"docNumber",key:"docNumber"},{title:"عملیات",key:"actions",render:(s,n,u)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{className:"bg-yellow-500 hover:bg-yellow-600 text-white text-xs px-2 py-1 rounded",onClick:()=>_(u),children:"ویرایش"}),e.jsx(g,{className:"bg-red-600 hover:bg-red-700 text-white text-xs px-2 py-1 rounded",onClick:()=>E(u),children:"حذف"})]})}],dataSource:i})]}),v&&a&&e.jsx(Q,{user:a,show:v,onCancel:()=>{w(!1),b(null)},onOk:A,defaultValues:d!==null?{amount:i[d].amount,date:i[d].date,docNumber:i[d].docNumber}:void 0}),e.jsx(G,{open:y,onClose:()=>c(!1)})]})}function Z(){return e.jsx(J,{})}export{Z as default};
