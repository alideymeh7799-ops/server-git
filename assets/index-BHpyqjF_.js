import{j as s,C as D,d as P,B as u,e as V}from"./index-akJh1a2u.js";import{u as I,A as l}from"./use-request-D0F366jR.js";import{r as a}from"./vendor-core-CiUIJZ_7.js";import A from"./modal-create-CK5XVHbs.js";import{e as F,S as x,I as M,F as E,f as T,c as B,s as h}from"./vendor-ui-DnFwFa5O.js";import"./vendor-utils-IiNHtr66.js";import"./index.esm-BGUB25Qb.js";const{Option:i}=x,K={person_id:null,yegan_id:null,number_hesab:null,onvan_hesab:null},J=()=>{const[f,b]=a.useState([]),[_]=F.useForm(),[j,g]=a.useState(""),[y,m]=a.useState(Date.now()),[n,c]=a.useState({show:!1,title:"افزودن عامل جدید",formValue:K}),r=I(),d=r.useGetData("api/amelkharid",{Authorization:l}),w=r.useUpdateData("api/amelkharid/"+n?.formValue.id,{"content-type":"application/json",Authorization:l}),v=r.usePostData("api/amelkharid",{"content-type":"application/json",Authorization:l}),k=r.useDeleteData("api/amelkharid/",{"content-type":"application/json",Authorization:l});a.useEffect(()=>{d.fetchData()},[y]),a.useEffect(()=>{const e=d.data;e?.success&&e.data&&b(e.data)},[d.data]);const p=()=>{c(e=>({...e,show:!1}))},S=async(e,t)=>{let o;t==="add"?o=await v.sendData({person_id:Number(e.person_id),yegan_id:Number(e.yegan_id),onvan_hesab:e.onvan_hesab,number_hesab:e.number_hesab}):o=await w.sendData({person_id:Number(e.person_id),yegan_id:Number(e.yegan_id),onvan_hesab:e.onvan_hesab,number_hesab:e.number_hesab}),o&&m(Date.now()),p()},C=async e=>{try{let t;e&&(t=await k.remove(e.toString())),t?.success?(h.success("با موفقیت حذف شد"),m(Date.now())):h.error("خطا در حذف")}catch(t){h.error(t.status==="500"?"خطا در ارتباط با سرور":"خطایی رخ داده است")}},N=[{title:"کد عامل خرید",dataIndex:"person_id",key:"person_id"},{title:"نام عامل خرید",dataIndex:"person_id",key:"person_id"},{title:"شماره حساب",dataIndex:"number_hesab",key:"number_hesab"},{title:"عنوان حساب",dataIndex:"onvan_hesab",key:"onvan_hesab"},{title:"عملیات",key:"actions",render:(e,t)=>s.jsxs(T,{children:[s.jsx(u,{className:"bg-chart1 text-white",onClick:()=>{_.setFieldsValue(t),c(o=>({...o,title:"ویرایش عامل خرید",show:!0,formValue:t}))},children:"ویرایش"}),s.jsx(B,{title:"آیا مطمئن هستید؟",onConfirm:()=>C(t.id?t.id:null),children:s.jsx(u,{className:"bg-error/70 hover:bg-error text-white",children:"حذف"})})]})}];return s.jsxs(D,{children:[s.jsxs(P,{className:"flex items-center justify-between flex-col sm:flex-row gap-4 sm:gap-0",children:[s.jsx("h1",{className:"text-lg font-semibold text-right w-full sm:w-auto",children:"مدیریت عاملین خرید"}),s.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[s.jsxs(x,{style:{width:160},children:[s.jsx(i,{value:"code",children:"کد عامل خرید"}),s.jsx(i,{value:"name",children:"نام عامل خرید"}),s.jsx(i,{value:"accountNumber",children:"شماره حساب"}),s.jsx(i,{value:"accountTitle",children:"عنوان حساب"})]}),s.jsx(M,{placeholder:"متن جستجو",value:j,onChange:e=>g(e.target.value),style:{width:250}}),s.jsx(u,{className:"text-white cursor-pointer",onClick:()=>c(e=>({...e,show:!0})),children:"افزودن عامل خرید"})]})]}),s.jsx(V,{children:s.jsx(E,{rowKey:"id",columns:N,dataSource:f,pagination:{pageSize:5}})}),n.show&&s.jsx(A,{title:n.title,show:n.show,formValue:n.formValue,onOk:S,onCancel:p})]})};export{J as default};
