import{aX as A,j as R,aY as D,aZ as $,a_ as S,a$ as T,b0 as W,b1 as B,b2 as H,b3 as K,b4 as U,b5 as V,b6 as X,b7 as _}from"./index-akJh1a2u.js";import{r as t}from"./vendor-core-CiUIJZ_7.js";class F extends t.Component{getSnapshotBeforeUpdate(f){const e=this.props.childRef.current;if(e&&f.isPresent&&!this.props.isPresent){const a=e.offsetParent,m=D(a)&&a.offsetWidth||0,n=this.props.sizeRef.current;n.height=e.offsetHeight||0,n.width=e.offsetWidth||0,n.top=e.offsetTop,n.left=e.offsetLeft,n.right=m-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function G({children:i,isPresent:f,anchorX:e,root:a}){const m=t.useId(),n=t.useRef(null),p=t.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:x}=t.useContext(A);return t.useInsertionEffect(()=>{const{width:g,height:s,top:E,left:r,right:l}=p.current;if(f||!n.current||!g||!s)return;const u=e==="left"?`left: ${r}`:`right: ${l}`;n.current.dataset.motionPopId=m;const c=document.createElement("style");x&&(c.nonce=x);const d=a??document.head;return d.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${m}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${s}px !important;
            ${u}px !important;
            top: ${E}px !important;
          }
        `),()=>{d.contains(c)&&d.removeChild(c)}},[f]),R.jsx(F,{isPresent:f,childRef:n,sizeRef:p,children:t.cloneElement(i,{ref:n})})}const Y=({children:i,initial:f,isPresent:e,onExitComplete:a,custom:m,presenceAffectsLayout:n,mode:p,anchorX:x,root:g})=>{const s=$(Z),E=t.useId();let r=!0,l=t.useMemo(()=>(r=!1,{id:E,initial:f,isPresent:e,custom:m,onExitComplete:u=>{s.set(u,!0);for(const c of s.values())if(!c)return;a&&a()},register:u=>(s.set(u,!1),()=>s.delete(u))}),[e,s,a]);return n&&r&&(l={...l}),t.useMemo(()=>{s.forEach((u,c)=>s.set(c,!1))},[e]),t.useEffect(()=>{!e&&!s.size&&a&&a()},[e]),p==="popLayout"&&(i=R.jsx(G,{isPresent:e,anchorX:x,root:g,children:i})),R.jsx(S.Provider,{value:l,children:i})};function Z(){return new Map}const P=i=>i.key||"";function v(i){const f=[];return t.Children.forEach(i,e=>{t.isValidElement(e)&&f.push(e)}),f}const O=({children:i,custom:f,initial:e=!0,onExitComplete:a,presenceAffectsLayout:m=!0,mode:n="sync",propagate:p=!1,anchorX:x="left",root:g})=>{const[s,E]=T(p),r=t.useMemo(()=>v(i),[i]),l=p&&!s?[]:r.map(P),u=t.useRef(!0),c=t.useRef(r),d=$(()=>new Map),[z,I]=t.useState(r),[C,w]=t.useState(r);W(()=>{u.current=!1,c.current=r;for(let h=0;h<C.length;h++){const o=P(C[h]);l.includes(o)?d.delete(o):d.get(o)!==!0&&d.set(o,!1)}},[C,l.length,l.join("-")]);const M=[];if(r!==z){let h=[...r];for(let o=0;o<C.length;o++){const y=C[o],b=P(y);l.includes(b)||(h.splice(o,0,y),M.push(y))}return n==="wait"&&M.length&&(h=M),w(v(h)),I(r),null}const{forceRender:L}=t.useContext(B);return R.jsx(R.Fragment,{children:C.map(h=>{const o=P(h),y=p&&!s?!1:r===C||l.includes(o),b=()=>{if(d.has(o))d.set(o,!0);else return;let j=!0;d.forEach(k=>{k||(j=!1)}),j&&(L?.(),w(c.current),p&&E?.(),a&&a())};return R.jsx(Y,{isPresent:y,initial:!u.current||e?void 0:!1,custom:f,presenceAffectsLayout:m,mode:n,root:g,onExitComplete:y?void 0:b,anchorX:x,children:h},o)})})},q={...V,...U,...K,...H},Q=X(q,_);export{O as A,Q as m};
